<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>flask_gatekeeper code documentation &mdash; flask-gatekeeper 1.0.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="flask-gatekeeper" href="readme.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> flask-gatekeeper
          </a>
              <div class="version">
                1.0.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">flask-gatekeeper</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">flask_gatekeeper code documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-flask_gatekeeper.gatekeeper">Gatekeeper()</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">flask-gatekeeper</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>flask_gatekeeper code documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/gatekeeper.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="flask-gatekeeper-code-documentation">
<h1>flask_gatekeeper code documentation<a class="headerlink" href="#flask-gatekeeper-code-documentation" title="Permalink to this headline"></a></h1>
<section id="module-flask_gatekeeper.gatekeeper">
<span id="gatekeeper"></span><h2>Gatekeeper()<a class="headerlink" href="#module-flask_gatekeeper.gatekeeper" title="Permalink to this headline"></a></h2>
<p>A simple banning &amp; rate limiting extension for Flask.</p>
<dl class="py class">
<dt class="sig sig-object py" id="flask_gatekeeper.gatekeeper.GateKeeper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">GateKeeper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">flask.app.Flask</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ban_rule</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_limit_rules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ip_header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">excluded_methods</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">list</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flask_gatekeeper/gatekeeper.html#GateKeeper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flask_gatekeeper.gatekeeper.GateKeeper" title="Permalink to this definition"></a></dt>
<dd><p>GateKeeper instance around a flask app.</p>
<p>Provides rate-limiting &amp; ban functions.</p>
<p>Rate limiting is done automatically,
but you have to specify when an IP should be reported, using <cite>.report()</cite> (usually in your login route when the creds are not valid)</p>
<p>ban_rule should be a dict {“count”:int,”window”:int,”duration”:int} where
- count is the number of reports before actually banning the IP
- window is the rolling time window to look for ban reports
- duration is the duration of the ban in seconds.</p>
<p>rate_limit_rules should be a list [{“count”:int,”window”:int},..] where
- count is the maximum number of requests
- window is the rolling time window for the rate count.</p>
<p>As an example, ban_rule={“count”:3,”window”:60,”duration”:600}, rate_limit_rules=[{“count”:20,”window”:1},{“count”:100,”window”:10}] would:
- ban any IP for 600s if it has been reported 3 times in the last 60s,
- rate limit any IP if it has made more than 20 requests in the last 1s or more than 100 requests in a 10s window.</p>
<p>If you do not set ban_rule, no banning will be done. Same goes for the rate limiting.</p>
<p>Requests made during the rate limiting period or ban period are not counted.</p>
<p>You can delay the init by omitting <cite>app</cite> here and calling <cite>.init_app()</cite> later.</p>
<p>If you set ip_header but the header is not present in the request, it falls back to the client seen by flask (which might be the proxy’s IP if using one) string, and any request made by potentially different clients will be added to this.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>app</strong> (<em>flask.Flask</em><em>, </em><em>optional</em>) – Flask app to wrap around. Defaults to None.</p></li>
<li><p><strong>ban_rule</strong> (<em>dict</em><em>, </em><em>optional</em>) – Global ban rule for the whole app. Defaults to None.</p></li>
<li><p><strong>rate_limit_rules</strong> (<em>list</em><em>, </em><em>optional</em>) – Global rate limit rules for the whole app. Defaults to None.</p></li>
<li><p><strong>ip_header</strong> (<em>str</em><em>, </em><em>optional</em>) – Header to check for the IP. useful with a proxy that will add a header with the ip of the actual client. Defaults to request.remote_addr.</p></li>
<li><p><strong>excluded_methods</strong> (<em>str</em><em>, </em><em>optional</em>) – Types of requests to ignore when counting requests. Can be GET, POST, HEAD, OPTIONS.. Defaults to None.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="flask_gatekeeper.gatekeeper.GateKeeper.bypass">
<span class="sig-name descname"><span class="pre">bypass</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">route</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flask_gatekeeper/gatekeeper.html#GateKeeper.bypass"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flask_gatekeeper.gatekeeper.GateKeeper.bypass" title="Permalink to this definition"></a></dt>
<dd><p>do not apply rate-limiting to this route</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flask_gatekeeper.gatekeeper.GateKeeper.init_app">
<span class="sig-name descname"><span class="pre">init_app</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">app</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flask_gatekeeper/gatekeeper.html#GateKeeper.init_app"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flask_gatekeeper.gatekeeper.GateKeeper.init_app" title="Permalink to this definition"></a></dt>
<dd><p>add our before request to flask now</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flask_gatekeeper.gatekeeper.GateKeeper.report">
<span class="sig-name descname"><span class="pre">report</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ip</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flask_gatekeeper/gatekeeper.html#GateKeeper.report"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flask_gatekeeper.gatekeeper.GateKeeper.report" title="Permalink to this definition"></a></dt>
<dd><p>Report the client who made the request, increasing its tally towards being banned.</p>
<p>If no ip arg is provided, uses the ip_header arg provided to the GateKeeper instance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ip</strong> (<em>str</em><em>, </em><em>optional</em>) – IP to ban. Defaults to None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="flask_gatekeeper.gatekeeper.GateKeeper.specific">
<span class="sig-name descname"><span class="pre">specific</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rate_limit_rules</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standalone</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flask_gatekeeper/gatekeeper.html#GateKeeper.specific"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flask_gatekeeper.gatekeeper.GateKeeper.specific" title="Permalink to this definition"></a></dt>
<dd><p>Route specific gatekeeper. Only for rate limiting purposes.</p>
<p>By defaults the specific rate_limit rule is set on top of the global instance rule.
A use-case could be a global per-minute rule, and a per-second bursting rule here
If you want to set a unique rate limite rule, set <cite>standalone</cite> to True.</p>
<p>You can supply a different ip_header, otherwise it will default to the instance configuration.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="flask_gatekeeper.gatekeeper.IP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">IP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ban_count</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rate_count</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/flask_gatekeeper/gatekeeper.html#IP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#flask_gatekeeper.gatekeeper.IP" title="Permalink to this definition"></a></dt>
<dd><p>IP record that keeps track of reports and requests made by that IP.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ban_count</strong> (<em>int</em>) – number of reports to keep</p></li>
<li><p><strong>rate_count</strong> (<em>int</em>) – number of requests to keep</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="readme.html" class="btn btn-neutral float-left" title="flask-gatekeeper" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, k0rventen.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>